<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PSeInt-IX - Nivel 1 ¬∑ Exploradores</title>
  <style>
    :root{ --ink:#eaf2ff; --neon:#22c55e; --muted:#2a3b66; }
    *{ box-sizing:border-box; }
    body{
      margin:0; min-height:100vh; display:flex; flex-direction:column;
      font-family:Poppins,system-ui,Segoe UI,Arial,sans-serif; color:var(--ink);
      background:#050913; position:relative; overflow:hidden;
    }
    canvas#stars{ position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; }
    header{
      text-align:center; padding:14px 16px; background:#162543; border-bottom:3px solid var(--neon);
      box-shadow:0 0 16px rgba(34,197,94,.6);
    }
    header h1{ margin:0; font-size:1.9rem; letter-spacing:.3px }
    #wrap{ flex:1; display:flex; gap:22px; max-width:1200px; margin:22px auto; padding:0 14px; }
    #book,#play{
      flex:1; border:2px solid var(--neon); border-radius:14px; padding:20px;
      background:linear-gradient(180deg,rgba(22,34,66,.95),rgba(10,20,38,.92));
      box-shadow:0 0 18px rgba(34,197,94,.45); overflow:auto; max-height:calc(100vh - 170px);
    }
    h3{ margin:.2rem 0 1rem 0; }
    .badge{ display:inline-block; padding:4px 10px; border:1px solid var(--neon); border-radius:999px; font-size:.85rem }
    .section-title{ display:flex; align-items:center; gap:10px; }
    .progressbar{ width:100%; background:var(--muted); height:14px; border-radius:8px; overflow:hidden; margin:.6rem 0; }
    .progress{ height:100%; width:0%; background:var(--neon); transition:width .25s ease; }
    .block{ background:#0f1e3a; border:1px solid #254075; border-radius:12px; padding:14px 16px; margin-bottom:12px; }
    .block h4{ margin:.2rem 0 .5rem 0; }
    .city{ background:#0c1833; border:1px dashed #2e4a88; }
    .hint{ opacity:.9; margin:-6px 0 10px 0; }
    .card{ background:#0b1630; border:1px solid #203b70; border-radius:12px; padding:14px 16px; }
    .choices{ display:flex; flex-direction:column; gap:8px; }
    button.choice{
      background:var(--neon); color:#072317; border:none; border-radius:10px;
      padding:10px 12px; font-weight:700; text-align:left; cursor:pointer;
    }
    button.choice:hover{ filter:brightness(1.05); }
    .msg{ margin-top:8px; }
    footer{
      text-align:center; padding:10px 14px; background:#0d1324; border-top:2px solid var(--neon);
      color:#aeb9d6; font-size:.95rem;
    }
    #overlay{
      position:fixed; top:0; left:0; right:0; bottom:0; background:#050913dd;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      z-index:10; color:white; text-align:center;
    }
    #overlay input{
      padding:10px; border-radius:8px; border:none; margin-top:10px; font-size:1rem;
    }
    #overlay button{
      margin-top:12px; padding:10px 16px; border:none; border-radius:8px;
      background:var(--neon); color:#04150f; font-weight:700; cursor:pointer;
    }
  </style>
</head>
<body>
  <canvas id="stars"></canvas>

  <div id="overlay">
    <h2>üåå Bienvenido a PSeInt-iX</h2>
    <p>Ingresa tu nombre completo para comenzar la aventura:</p>
    <input type="text" id="playerName" placeholder="Tu nombre completo" />
    <button onclick="startGame()">Comenzar</button>
  </div>

  <header>
    <h1>üåå PSeInt-iX ‚Äî Nivel 1 ¬∑ Exploradores</h1>
  </header>

  <main id="wrap" style="display:none">
    <!-- üìñ LIBRO -->
    <section id="book" aria-live="polite">
      <div class="section-title">
        <h3>üìñ Libro de la Sabidur√≠a</h3>
        <span class="badge" id="badge">Lecci√≥n 1/4</span>
      </div>
      <h3 id="title">üèõÔ∏è Plaza Algoritmia</h3>
      <div id="theory"></div>
      <div class="progressbar"><div class="progress" id="pbar"></div></div>
      <p><b>Progreso de la lecci√≥n:</b> <span id="ptext">0/10</span></p>
    </section>

    <!-- üéÆ RETOS -->
    <section id="play" aria-live="polite">
      <div class="section-title"><h3>üéÆ Retos</h3></div>
      <p class="hint"><em>Instrucci√≥n:</em> Selecciona la <b>opci√≥n correcta</b> para avanzar.</p>
      <h3 id="ctitle">Reto 1</h3>
      <div id="challenge"></div>
    </section>
  </main>

  <footer>Aprendiendo con @LaProfeVivy ‚ú®</footer>

  <script>
    // ================= ESTRELLAS FONDO =================
    const canvas=document.getElementById("stars"),ctx=canvas.getContext("2d");
    let w,h,stars=[];
    function resize(){ w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; }
    window.addEventListener("resize",resize); resize();
    function initStars(){
      stars=[];
      for(let i=0;i<150;i++){
        stars.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*2+1,dx:(Math.random()-0.5)*0.2,dy:(Math.random()-0.5)*0.2});
      }
    }
    initStars();
    let shooting={x:0,y:0,len:0,active:false};
    function animate(){
      ctx.clearRect(0,0,w,h);
      ctx.fillStyle="white";
      stars.forEach(s=>{
        s.x+=s.dx; s.y+=s.dy;
        if(s.x<0||s.x>w) s.dx*=-1;
        if(s.y<0||s.y>h) s.dy*=-1;
        ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();
      });
      if(shooting.active){
        ctx.strokeStyle="white"; ctx.lineWidth=2;
        ctx.beginPath(); ctx.moveTo(shooting.x,shooting.y);
        ctx.lineTo(shooting.x+shooting.len,shooting.y+shooting.len*0.3); ctx.stroke();
        shooting.x+=10; shooting.y+=3;
        if(shooting.x> w || shooting.y>h) shooting.active=false;
      }else if(Math.random()<0.002){
        shooting={x:Math.random()*w*0.5,y:Math.random()*h*0.3,len:80,active:true};
      }
      requestAnimationFrame(animate);
    }
    animate();

    // ================== TEOR√çA ==================
    const Theory={
      plaza:`<div class="block"><h4>üß† Algoritmos</h4><p>Un algoritmo es un conjunto finito de pasos ordenados para resolver un problema. Deben ser claros, finitos (inicio y fin) y ordenados.</p></div>
             <div class="block city"><h4>üèõÔ∏è Plaza Algoritmia</h4><p>El tablero digital que reporta el funcionamiento solo se enciende si los pasos est√°n en orden. Rescata la plaza corrigiendo procesos.</p></div>`,
      parque:`<div class="block"><h4>üß† Variables</h4><p>Una variable guarda datos. Tipos: num√©rico, texto (entre comillas), l√≥gico (Verdadero/Falso). Buenos nombres son descriptivos, sin espacios y comenzando en letra.</p></div>
             <div class="block city"><h4>üå± Parque de Variables</h4><p>Los √°rboles luminosos guardan valores. A veces estos valores y variables se pueden unir (concatenar +) conservando la norma. Sin variables correctas, el parque se apaga.</p></div>`,
      taller:`<div class="block"><h4>üß† Operaciones</h4><p>Operadores: +, ‚àí, √ó, √∑, %, relacionales (>,<,==) y l√≥gicos (Y, O, NO). La prioridad se aclara con par√©ntesis.</p></div>
              <div class="block city"><h4>‚öôÔ∏è Taller de Operatoria</h4><p>M√°quinas que convierten c√°lculos en energ√≠a. Si se equivoca la operaci√≥n, fallan.</p></div>`,
      barrio:`<div class="block"><h4>üß† Secuencias</h4><p>Las instrucciones se ejecutan en orden. El resultado depende del orden exacto.</p></div>
              <div class="block city"><h4>üèòÔ∏è Barrio Secuencial</h4><p>Robots, sem√°foros y portones necesitan instrucciones correctas para fluir.</p></div>`
    };

    // ================= LECCIONES Y RETOS =================
    const Lessons = [
      {
        badge:"Lecci√≥n 1/4", title:"üèõÔ∏è Plaza Algoritmia", theory:Theory.plaza,
        retos:[
          {q:"¬øCu√°l es el orden correcto para que un dron cruce la plaza?",options:[{t:"Iniciar ‚Üí Avanzar ‚Üí Llegar",ok:true},{t:"Girar ‚Üí Avanzar ‚Üí Llegar ",ok:false},{t:"Llegar ‚Üí Avanzar ‚Üí Girar",ok:false},{t:"Iniciar ‚Üí Llegar ‚Üí Girar  ",ok:false}],feedback:"Los drones necesitan seguir pasos secuenciales para no perderse en la plaza."},
          {q:"Fuente central: orden correcto para encenderla",options:[{t:"Encender bomba ‚Üí Abrir v√°lvula ‚Üí Activar luces",ok:true},{t:"Activar luces ‚Üí Abrir v√°lvula ‚Üí Encender bomba",ok:false},{t:"Abrir v√°lvula ‚Üí Encender bomba ‚Üí Activar luces",ok:false},{t:"Encender bomba ‚Üí Activar luces ‚Üí Abrir v√°lvula",ok:false}],feedback:"Primero la bomba, luego la v√°lvula y al final las luces."},
          {q:"Tranv√≠a el√©ctrico: secuencia v√°lida",options:[{t:"Abrir puertas ‚Üí Subir pasajeros ‚Üí Cerrar puertas ‚Üí Arrancar",ok:true},{t:"Cerrar puertas ‚Üí Arrancar ‚Üí Abrir puertas ‚Üí Subir pasajeros",ok:false},{t:"Subir pasajeros ‚Üí Cerrar puertas ‚Üí Arrancar ‚Üí Abrir puertas",ok:false},{t:"Abrir puertas ‚Üí Cerrar puertas ‚Üí Subir pasajeros ‚Üí Arrancar",ok:false}],feedback:"Los pasajeros deben subir antes de arrancar."},
          {q:"Kiosko autom√°tico: preparar un jugo",options:[{t:"Recibir pedido ‚Üí Tomar vaso ‚Üí Llenar vaso ‚Üí Entregar",ok:true},{t:"Tomar vaso ‚Üí Entregar ‚Üí Recibir pedido ‚Üí Llenar vaso",ok:false},{t:"Recibir pedido ‚Üí Llenar vaso ‚Üí Tomar vaso ‚Üí Entregar",ok:false},{t:"Recibir pedido ‚Üí Entregar ‚Üí Tomar vaso ‚Üí Llenar vaso",ok:false}],feedback:"La secuencia correcta asegura que el cliente reciba su pedido."},
          {q:"Dron gu√≠a tur√≠stico: ruta m√≠nima a la torre",options:[{t:"Iniciar ‚Üí Ir recto ‚Üí Llegar a torre",ok:true},{t:"Iniciar ‚Üí Llegar a torre ‚Üí Ir recto",ok:false},{t:"Llegar a torre ‚Üí Ir recto ‚Üí Girar",ok:false},{t:"Girar ‚Üí Ir recto ‚Üí Llegar a torre",ok:false}],feedback:"El dron sigue un camino con inicio y final."},
          {q:"Escaleras hologr√°ficas: sincronizaci√≥n",options:[{t:"Encender holograma ‚Üí Proyectar escalones ‚Üí Asegurar pasamanos",ok:true},{t:"Proyectar escalones ‚Üí Asegurar pasamanos ‚Üí Encender holograma",ok:false},{t:"Asegurar pasamanos ‚Üí Encender holograma ‚Üí Proyectar escalones",ok:false},{t:"Proyectar escalones ‚Üí Encender holograma ‚Üí Asegurar pasamanos",ok:false}],feedback:"La proyecci√≥n solo funciona si se enciende primero el holograma."},
          {q:"Patrulla rob√≥tica: ronda correcta que sigue las manecillas del reloj",options:[{t:"Norte ‚Üí Este ‚Üí Sur ‚Üí Oeste",ok:true},{t:"Oeste ‚Üí Sur ‚Üí Este ‚Üí Norte",ok:false},{t:"Este ‚Üí Norte ‚Üí Oeste ‚Üí Sur",ok:false},{t:"Norte ‚Üí Sur ‚Üí Este ‚Üí Oeste",ok:false}],feedback:"La patrulla debe recorrer en orden los cuatro puntos cardinales."},
          {q:"Robot de limpieza: orden adecuado",options:[{t:"Encender agua ‚Üí Barrer ‚Üí Aspirar ‚Üí Secar",ok:true},{t:"Barrer ‚Üí Secar ‚Üí Encender agua ‚Üí Aspirar",ok:false},{t:"Aspirar ‚Üí Encender agua ‚Üí Barrer ‚Üí Secar",ok:false},{t:"Secar ‚Üí Barrer ‚Üí Aspirar ‚Üí Encender agua",ok:false}],feedback:"El proceso inicia encendiendo el agua y termina secando."},
          {q:"Pantalla informativa: mensajes en secuencia",options:[{t:"Bienvenido ‚Üí Nombre del visitante ‚Üí Mensaje final",ok:true},{t:"Nombre del visitante ‚Üí Bienvenido ‚Üí Mensaje final",ok:false},{t:"Mensaje final ‚Üí Bienvenido ‚Üí Nombre",ok:false},{t:"Bienvenido ‚Üí Mensaje final ‚Üí Nombre",ok:false}],feedback:"La bienvenida siempre va primero."},
          {q:"Escudo de la Plaza: arranque seguro",options:[{t:"Iniciar ‚Üí Verificar sensores ‚Üí Cargar energ√≠a ‚Üí Activar n√∫cleo ‚Üí Desplegar escudo",ok:true},{t:"Cargar energ√≠a ‚Üí Iniciar ‚Üí Activar n√∫cleo ‚Üí Verificar sensores ‚Üí Desplegar escudo",ok:false},{t:"Verificar sensores ‚Üí Desplegar escudo ‚Üí Activar n√∫cleo ‚Üí Cargar energ√≠a ‚Üí Iniciar",ok:false},{t:"Iniciar ‚Üí Cargar energ√≠a ‚Üí Desplegar escudo ‚Üí Verificar sensores ‚Üí Activar n√∫cleo",ok:false}],feedback:"El escudo requiere pasos seguros antes de activarse."}
        ]
      },
      {
        badge:"Lecci√≥n 2/4", title:"üå± Parque de Variables", theory:Theory.parque,
        retos:[
          {q:"¬øAsignaci√≥n v√°lida para nombre?",options:[{t:'nombre ‚Üê "Ana"',ok:true},{t:"nombre ‚Üê 22",ok:false},{t:"nombre ‚Üê verdadero",ok:false},{t:"nombre ‚Üê nombre + 1",ok:false}],feedback:"El nombre debe ser texto."},
          {q:"Edad de un ciudadano:",options:[{t:"edad ‚Üê 21",ok:true},{t:'edad ‚Üê "veintiuno"',ok:false},{t:"edad ‚Üê verdadero",ok:false},{t:'edad ‚Üê "21 a√±os"',ok:false}],feedback:"La edad es un valor num√©rico."},
          {q:"Las flores booleanas se encienden con:",options:[{t:"verdadero",ok:true},{t:'"s√≠"',ok:false},{t:"1.5",ok:false},{t:'"encender"',ok:false}],feedback:"Las variables l√≥gicas usan verdadero o falso."},
          {q:"Color de luz del √°rbol (valor correcto):",options:[{t:'color ‚Üê "Azul"',ok:true},{t:"color ‚Üê 255",ok:false},{t:"color ‚Üê verdadero",ok:false},{t:"color ‚Üê nombre",ok:false}],feedback:"El color debe ser texto."},
          {q:"Concatenaci√≥n de saludo en pantalla:",options:[{t:'saludo ‚Üê "Hola " + nombre',ok:true},{t:'saludo ‚Üê "Hola " - nombre',ok:false},{t:'saludo ‚Üê "Hola ", nombre',ok:false},{t:'saludo ‚Üê nombre - "Hola"',ok:false}],feedback:"La concatenaci√≥n usa el s√≠mbolo +."},
          {q:"Destino del robot gu√≠a:",options:[{t:'destino ‚Üê "Torre Central"',ok:true},{t:"destino ‚Üê 1024.3",ok:false},{t:"destino ‚Üê verdadero",ok:false},{t:"destino ‚Üê edad",ok:false}],feedback:"El destino es un texto."},
          {q:"Estado del dron de control:",options:[{t:"activo ‚Üê verdadero",ok:true},{t:'activo ‚Üê "true"',ok:false},{t:"activo ‚Üê 2",ok:false},{t:"activo ‚Üê color",ok:false}],feedback:"Activo es un valor l√≥gico verdadero/falso."},
          {q:"Inicializa la variable carrera:",options:[{t:'carrera ‚Üê "Ingenier√≠a"',ok:true},{t:"carrera ‚Üê",ok:false},{t:"carrera ‚Üê verdadero",ok:false},{t:"carrera ‚Üê 3*nombre",ok:false}],feedback:"La carrera se guarda como texto."},
          {q:"Tipo correcto para la variable edad:",options:[{t:"Num√©rico",ok:true},{t:"Texto",ok:false},{t:"L√≥gico",ok:false},{t:"Fecha",ok:false}],feedback:"Edad es num√©rica."},
          {q:"La Ficha de Ciudadano debe incluir:",options:[{t:"nombre, edad, carrera, colorFavorito",ok:true},{t:"solo edad",ok:false},{t:"carrera y activo",ok:false},{t:"nombre y destino",ok:false}],feedback:"La ficha incluye varios atributos b√°sicos."}
        ]
      },
      {
        badge:"Lecci√≥n 3/4", title:"‚öôÔ∏è Taller de Operatoria", theory:Theory.taller,
        retos:[
          {q:"Generador de suma:",options:[{t:"resultado ‚Üê 3 + 2",ok:true},{t:"resultado ‚Üê 3 √ó 2",ok:false},{t:"resultado ‚Üê 3 / 2",ok:false},{t:"resultado ‚Üê 3 ‚àí 2",ok:false}],feedback:"La suma utiliza el operador +."},
          {q:"Resta de recursos correcta:",options:[{t:"faltan ‚Üê 10 ‚àí 4",ok:true},{t:"faltan ‚Üê 10 + 4",ok:false},{t:"faltan ‚Üê 10 √ó 4",ok:false},{t:"faltan ‚Üê 10 √∑ 4",ok:false}],feedback:"La resta se hace con el signo ‚àí."},
          {q:"Multiplicador de suministros:",options:[{t:"total ‚Üê precio * cantidad",ok:true},{t:"total ‚Üê precio + cantidad",ok:false},{t:"total ‚Üê precio / cantidad",ok:false},{t:"total ‚Üê cantidad ‚àí precio",ok:false}],feedback:"El total es precio multiplicado por cantidad."},
          {q:"Divisi√≥n de energ√≠a por drones:",options:[{t:"parte ‚Üê 100 / 5",ok:true},{t:"parte ‚Üê 100 * 5",ok:false},{t:"parte ‚Üê 100 ‚àí 5",ok:false},{t:"parte ‚Üê 100 + 5",ok:false}],feedback:"La energ√≠a se reparte dividiendo."},
          {q:"Comparador de bater√≠as (robot A con m√°s carga):",options:[{t:"bateriaA > bateriaB",ok:true},{t:"bateriaA == bateriaB",ok:false},{t:"bateriaA + bateriaB",ok:false},{t:"bateriaA < bateriaB",ok:false}],feedback:"El s√≠mbolo > indica que A tiene m√°s que B."},
          {q:"Term√≥metro digital por debajo del umbral:",options:[{t:"temperatura < 30",ok:true},{t:'temperatura = "baja"',ok:false},{t:"temperatura + 30",ok:false},{t:"30 < temperatura == verdadero",ok:false}],feedback:"Las comparaciones usan < o >."},
          {q:"Concatenaci√≥n de saludo:",options:[{t:'mensaje ‚Üê "Hola " + nombre',ok:true},{t:'mensaje ‚Üê "Hola " - nombre',ok:false},{t:"mensaje ‚Üê nombre / Hola",ok:false},{t:"mensaje ‚Üê verdadero + nombre",ok:false}],feedback:"Para concatenar se usa el +."},
          {q:"Prioridad correcta de operaciones:",options:[{t:"resultado ‚Üê (3 + 2) * 5",ok:true},{t:"resultado ‚Üê 3 + 2 * 5 (sin par√©ntesis)",ok:false},{t:"resultado ‚Üê 3 + (2 * 5) - 0 sin par√©ntesis",ok:false},{t:"resultado ‚Üê 3 + 2 * (5 ‚àí 5) + 5",ok:false}],feedback:"Los par√©ntesis cambian la prioridad."},
          {q:"¬øQu√© operaci√≥n es inv√°lida?",options:[{t:"5 / 0",ok:true},{t:"(8 ‚àí 3) * 2",ok:false},{t:"10 % 3",ok:false},{t:"4 + 4 * 2",ok:false}],feedback:"No se puede dividir entre cero."},
          {q:"Para encender el taller principal de Operatoria se requiere:",options:[{t:"usar suma, resta y multiplicaci√≥n",ok:true},{t:"booleanos",ok:false},{t:"s√≥lo concatenar textos",ok:false},{t:"ninguna operaci√≥n",ok:false}],feedback:"El taller necesita varias operaciones b√°sicas."}
        ]
      },
      {
        badge:"Lecci√≥n 4/4", title:"üèòÔ∏è Barrio Secuencial", theory:Theory.barrio,
        retos:[
          {q:"Robot mensajero (Entrega correcta):",options:[{t:"Ir ‚Üí Recoger ‚Üí Entregar",ok:true},{t:"Entregar ‚Üí Ir ‚Üí Recoger",ok:false},{t:"Recoger ‚Üí Entregar ‚Üí Ir",ok:false},{t:"Ir ‚Üí Entregar ‚Üí Recoger",ok:false}],feedback:"El mensajero primero va, luego recoge y finalmente entrega."},
          {q:"Cinta transportadora hacia dron:",options:[{t:"Activar cinta ‚Üí Mover paquete ‚Üí Entregar al dron",ok:true},{t:"Mover paquete ‚Üí Entregar ‚Üí Activar cinta",ok:false},{t:"Entregar ‚Üí Activar cinta ‚Üí Mover",ok:false},{t:"Activar ‚Üí Entregar ‚Üí Mover",ok:false}],feedback:"La cinta se activa primero, luego transporta y al final entrega."},
          {q:"Port√≥n digital de seguridad:",options:[{t:"Abrir ‚Üí Revisar ‚Üí Cerrar",ok:true},{t:"Revisar ‚Üí Abrir ‚Üí Cerrar",ok:false},{t:"Cerrar ‚Üí Revisar ‚Üí Abrir",ok:false},{t:"Abrir ‚Üí Cerrar ‚Üí Revisar",ok:false}],feedback:"El port√≥n debe abrirse, revisarse y cerrarse en ese orden."},
          {q:"Sem√°foro inteligente:",options:[{t:"Verde ‚Üí Amarillo ‚Üí Rojo",ok:true},{t:"Rojo ‚Üí Verde ‚Üí Amarillo",ok:false},{t:"Amarillo ‚Üí Rojo ‚Üí Verde",ok:false},{t:"Verde ‚Üí Rojo ‚Üí Amarillo",ok:false}],feedback:"El sem√°foro sigue el orden habitual verde-amarillo-rojo."},
          {q:"Puente retr√°ctil sobre el r√≠o de datos:",options:[{t:"Bajar ‚Üí Cruzar ‚Üí Subir",ok:true},{t:"Subir ‚Üí Bajar ‚Üí Cruzar",ok:false},{t:"Cruzar ‚Üí Bajar ‚Üí Subir",ok:false},{t:"Bajar ‚Üí Subir ‚Üí Cruzar",ok:false}],feedback:"Primero baja, luego cruzan y al final sube."},
          {q:"Casa inteligente (Dar la bienvenida):",options:[{t:"Encender luces ‚Üí M√∫sica ‚Üí muestra texto en pantalla",ok:true},{t:"Muestra texto en pantalla ‚Üí M√∫sica ‚Üí Luces",ok:false},{t:"M√∫sica ‚Üí muestra texto en pantalla ‚Üí Luces",ok:false},{t:"Luces ‚Üí Muestra texto en pantalla ‚Üí M√∫sica",ok:false}],feedback:"La bienvenida enciende luces, pone m√∫sica y muestra texto en la pantalla."},
          {q:"Despacho de drones de reparto:",options:[{t:"Preparar paquete ‚Üí Cargar ‚Üí Enviar",ok:true},{t:"Enviar ‚Üí Preparar ‚Üí Cargar",ok:false},{t:"Cargar ‚Üí Enviar ‚Üí Preparar",ok:false},{t:"Preparar ‚Üí Enviar ‚Üí Cargar",ok:false}],feedback:"El dron se prepara, se carga y luego se env√≠a."},
          {q:"Estaci√≥n de recarga:",options:[{t:"Conectar ‚Üí Cargar ‚Üí Desconectar",ok:true},{t:"Desconectar ‚Üí Cargar ‚Üí Conectar",ok:false},{t:"Cargar ‚Üí Desconectar ‚Üí Conectar",ok:false},{t:"Conectar ‚Üí Desconectar ‚Üí Cargar",ok:false}],feedback:"El ciclo correcto es conectar, cargar y desconectar."},
          {q:"Pasarela hologr√°fica:",options:[{t:"Encender proyector ‚Üí Mostrar escalones",ok:true},{t:"Mostrar escalones ‚Üí Encender proyector",ok:false},{t:"Subir escalones ‚Üí Encender proyector",ok:false},{t:"Encender proyector ‚Üí Subir escalones ‚Üí Mostrar",ok:false}],feedback:"Primero se enciende el proyector, luego se muestran los escalones."},
          {q:"Turista robot (pseudoc√≥digo breve):",options:[{t:"Paso1 ‚Üí Paso2 ‚Üí Paso3 ‚Üí Paso4",ok:true},{t:"Paso4 ‚Üí Paso3 ‚Üí Paso2 ‚Üí Paso1",ok:false},{t:"Paso1 ‚Üí Paso3 ‚Üí Paso2 ‚Üí Paso4",ok:false},{t:"Paso2 ‚Üí Paso1 ‚Üí Paso4 ‚Üí Paso3",ok:false}],feedback:"Los pasos secuenciales deben seguir un orden l√≥gico."}
        ]
      }
    ];

    // ================== L√ìGICA JUEGO ==================
    const $=id=>document.getElementById(id);
    let L=0,R=0,player="";
    function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}
    function startGame(){
      const name=$("playerName").value.trim();
      if(!name){alert("Por favor ingresa tu nombre");return;}
      player=name;
      $("overlay").style.display="none";
      $("wrap").style.display="flex";
      renderBook(); renderChallenge();
    }
    function renderBook(){
      const cur=Lessons[L]; $("badge").textContent=cur.badge; $("title").textContent=cur.title; $("theory").innerHTML=cur.theory;
      $("pbar").style.width=`${(R/10)*100}%`; $("ptext").textContent=`${R}/10`;
    }
    function renderChallenge(){
      const cur=Lessons[L], reto=cur.retos[R];
      $("ctitle").textContent=`Reto ${R+1}`;
      const opts=shuffle(reto.options.map(o=>({...o})));
      let html=`<div class="card"><p>${reto.q}</p><div class="choices">`;
      for(const o of opts){ html+=`<button class="choice" onclick="check(${o.ok},'${reto.feedback}')">${o.t}</button>`; }
      html+=`</div><div id="msg" class="msg"></div></div>`; $("challenge").innerHTML=html;
    }
    function check(isOk,fb){
      const msg=$("msg");
      if(isOk){
        msg.textContent="‚úÖ Correcto. "+fb;
        setTimeout(()=>{R++; if(R>=10){L++; if(L>=Lessons.length){endGame(); return;} R=0; renderBook();} renderChallenge();},5000);
      }else{ msg.textContent="‚ùå Incorrecto. Intenta otra opci√≥n."; }
      $("pbar").style.width=`${(R/10)*100}%`; $("ptext").textContent=`${R}/10`;
    }
    function endGame(){
      const d=new Date();
      $("book").innerHTML=`<h3>üèÜ Nivel completado</h3><p>üéâ ¬°Felicitaciones, <b>${player}</b>! Has completado el Nivel 1 el ${d.toLocaleDateString()} a las ${d.toLocaleTimeString()}.</p>`;
      $("play").innerHTML="<h3>üéâ ¬°Terminaste los 40 retos!</h3><p>Prep√°rate para el Nivel 2: Constructores de PSeInt-IX.</p>";
    }
  </script>
</body>
</html>
